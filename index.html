<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ÎπÑÏóêÏä§Ìä∏ Ïπ¥Îã¨Î°úÍ∑∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/3/turn.min.js"></script>
  <style>
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f9f9f9; }
    .navbar {
      display: flex; justify-content: space-between; align-items: center;
      background-color: #333; color: white; padding: 10px 20px;
    }
    .navbar-left { font-size: 20px; }
    .navbar-right {
      display: flex; gap: 10px; align-items: center;
    }
    .sound-toggle {
      background-color: white; font-size: 18px; border: none;
      cursor: pointer; padding: 6px 12px; border-radius: 5px;
    }
    .navbar a {
      background-color: white; color: black; text-decoration: none;
      font-size: 16px; padding: 6px 12px; border-radius: 5px;
      display: flex; align-items: center;
    }
    .navbar a img {
      height: 24px; margin-right: 6px;
    }
    #intro {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #fff; z-index: 9999;
      display: flex; flex-direction: column;
      justify-content: center; align-items: center;
    }
    #intro h1 { font-size: 64px; margin: 0; font-weight: bold; }
    #intro h2 { font-size: 40px; margin: 10px 0 30px 0; }
    #intro button {
      padding: 12px 24px; font-size: 18px;
      background-color: #333; color: white; border: none;
      border-radius: 8px; cursor: pointer;
    }
    #flipbook {
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .page {
      display: flex; justify-content: center;
      align-items: center; background: white;
    }
    .page img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      display: block;
      margin: auto;
    }
    .nav-buttons {
      text-align: center; position: fixed; bottom: 50px; width: 100%;
      background: rgba(255,255,255,0.95); z-index: 999;
      padding: 10px 0; display: flex; justify-content: center;
      align-items: center; gap: 4px; flex-wrap: nowrap; overflow-x: auto;
    }
    .nav-buttons button {
      font-size: 14px; padding: 6px 10px;
      background-color: #333; color: white; border: none;
      border-radius: 20px; cursor: pointer; transition: background 0.3s;
      white-space: nowrap;
    }
    .nav-buttons button:hover { background-color: #555; }
    .page-number {
      font-size: 13px; color: #555;
      white-space: nowrap;
    }
    .page-input {
      width: 40px; padding: 4px; font-size: 13px;
      border-radius: 5px; border: 1px solid #ccc;
    }
  </style>
  <style>
    .zoom-lens {
      position: absolute;
      border: 2px solid #333;
      border-radius: 8px;
      width: 500px;
      height: 250px;
      overflow: hidden;
      pointer-events: none;
      display: none;
      z-index: 1000;
      background: white;
    }
    .zoom-lens img {
      position: absolute;
      transform: scale(var(--zoom-scale));
      transform-origin: top left;
    }
  </style>
<style>:root { --zoom-scale: 1.5; }</style>
</head>
<body>

<div id="intro">
  <h1>B-EST</h1>
  <h2>CATALOG</h2>
  <button onclick="startCatalog()">ÌéºÏ≥êÎ≥¥Í∏∞</button>
</div>

<div class="navbar">
  <div class="navbar-left">ÎπÑÏóêÏä§Ìä∏ Ïπ¥Îã¨Î°úÍ∑∏</div>
  <div class="navbar-right">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>
    <a href="https://www.bestnail.kr" target="_blank">
      <img src="ÎπÑÏóêÏä§Ìä∏ Î°úÍ≥†(Îî±ÎßûÍ≤å).png" alt="Î°úÍ≥†">
      ÏáºÌïëÎ™∞
    </a>
  </div>
</div>

<div id="flipbook"></div>
<div class="zoom-lens" id="zoomLens"><img id="zoomImg" src="" /></div>

<div class="nav-buttons">
  <button id="first">‚èÆ</button>
  <button id="prev">‚¨Ö Ïù¥Ï†Ñ</button>
  <span class="page-number" id="page-number">1 / 83</span>
  <input type="number" id="pageInput" min="1" max="83" class="page-input" placeholder="ÌéòÏù¥ÏßÄ" />
  <button id="next">Îã§Ïùå ‚û°</button>
  <button id="last">‚è≠</button>
</div>

<audio id="flipSound" src="page-flip.mp3" preload="auto"></audio>

<script>
  const totalPages = 83;
  const pages = [];
  let soundEnabled = true;
let flipVolume = 1.0;

  function buildPages() {
    pages.length = 0;
    for (let i = 1; i <= totalPages; i++) {
      const num = String(i).padStart(2, '0');
      pages.push(`<div class='page'><img src='${num}.jpg' loading='lazy' /></div>`);
    }
  }

  function getDisplayMode() {
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const isPortrait = window.innerHeight > window.innerWidth;
    return isMobile && isPortrait ? 'single' : 'double';
  }

  function playFlipSound() {
    const audio = document.getElementById("flipSound");
    if (soundEnabled && audio) {
      
      audio.volume = flipVolume;
      audio.currentTime = 0;
      audio.play().catch(() => {});
    }
  }

  function toggleSound() {
    if (!soundEnabled) {
      flipVolume = 1.0;
    } else {
      flipVolume = flipVolume === 1.0 ? 0.5 : (flipVolume === 0.5 ? 0 : 1.0);
    }
    soundEnabled = flipVolume > 0;
    const symbol = flipVolume === 1.0 ? "üîä" : (flipVolume === 0.5 ? "üîâ" : "üîá");
    document.getElementById("soundToggle").textContent = symbol;
}

  function updateButtons() {
    const total = totalPages;
    const current = $("#flipbook").turn("page");
    const view = $("#flipbook").turn("view");
    const text = view.length > 1 ? `${Math.min(...view)}-${Math.max(...view)} / ${total}` : `${current} / ${total}`;
    $("#page-number").text(text);
    $("#prev").css("display", current > 1 ? "inline-block" : "none");
    $("#next").css("display", current < total ? "inline-block" : "none");
  }

  function waitForImages(callback) {
    const imgs = $("#flipbook img");
    let loaded = 0;
    const total = imgs.length;
    if (total === 0) return callback();

    imgs.each(function () {
      if (this.complete) {
        loaded++;
        if (loaded === total) callback();
      } else {
        $(this).on("load", function () {
          loaded++;
          if (loaded === total) callback();
        }).on("error", function () {
          loaded++;
          if (loaded === total) callback();
        });
      }
    });
  }

  function initializeFlipbook() {
    buildPages();
    const maxWidth = 1000;
    const screenWidth = window.innerWidth;
    const width = Math.min(screenWidth * 0.95, maxWidth);
    const height = width * 1.3;
    const displayMode = getDisplayMode();

    const flipbook = $("#flipbook");
    const currentPageBefore = flipbook.data("turn") ? flipbook.turn("page") : 1;
    if (flipbook.data("turn")) {
      flipbook.turn("destroy");
    }

    flipbook.html(pages.join("\n"));

    waitForImages(() => {
      flipbook.turn({
        width: displayMode === 'single' ? width : width * 2,
        height: height,
        autoCenter: true,
        display: displayMode,
        gradients: true,
        duration: 1200,
        elevation: 50,
        acceleration: true,
        turnCorners: "",
        when: {
          turning: function(e, page, view) {
            e.stopPropagation();
          }
        }
      });
      updateButtons();
      const currentPage = flipbook.turn("page") || 1;
      flipbook.turn("page", currentPageBefore);
    });
  }

  function startCatalog() {
    document.getElementById("intro").style.display = "none";
    initializeFlipbook();
  }

  $(document).ready(function () {
    $(document).on("click", "#first", () => { $("#flipbook").turn("page", 1); playFlipSound(); });
    $(document).on("click", "#last", () => { $("#flipbook").turn("page", totalPages); playFlipSound(); });
    $(document).on("click", "#prev", () => { $("#flipbook").turn("previous"); playFlipSound(); });
    $(document).on("click", "#next", () => { $("#flipbook").turn("next"); playFlipSound(); });

    $(document).on("keydown", "#pageInput", function(e) {
      if (e.key === "Enter") {
        const input = parseInt($(this).val(), 10);
        if (!isNaN(input) && input >= 1 && input <= totalPages) {
          $("#flipbook").turn("page", input);
          playFlipSound();
        } else {
          alert("1Î∂ÄÌÑ∞ " + totalPages + " ÏÇ¨Ïù¥Ïùò Ï†ïÏàòÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");
        }
      }
    });

    let lastWidth = window.innerWidth;
    let prevRatio = window.devicePixelRatio;

    function handleResizeOrZoom() {
      const newRatio = window.devicePixelRatio;
      if (Math.abs(window.innerWidth - lastWidth) > 50 || newRatio !== prevRatio) {
        lastWidth = window.innerWidth;
        prevRatio = newRatio;
        setTimeout(() => {
          requestAnimationFrame(() => {
            initializeFlipbook();
          });
        }, 200);
      }
    }

    $(window).on("resize orientationchange", handleResizeOrZoom);

    $("#flipbook").on("turned", () => {
      updateButtons();
      playFlipSound();
    });

    document.addEventListener("click", function (e) {
      const flipbook = document.getElementById("flipbook");
      if (!flipbook.contains(e.target)) return;
      if ($("#flipbook").turn("animating")) return;

      const rect = flipbook.getBoundingClientRect();
      const xRatio = (e.clientX - rect.left) / rect.width;
      if (xRatio > 0.5) {
        $("#flipbook").turn("next");
      } else {
        $("#flipbook").turn("previous");
      }
      playFlipSound();
    });

    // ÎßàÏö∞Ïä§ ÌôïÎåÄ Í∏∞Îä• (PCÏóêÏÑúÎßå)
    const zoomLens = document.getElementById("zoomLens");
    const zoomImg = document.getElementById("zoomImg");
    let zoomScale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--zoom-scale')) || 1.5;

    document.addEventListener("mousemove", function (e) {
      zoomScale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--zoom-scale')) || 1.5;
      if (window.innerWidth <= 768) return zoomLens.style.display = "none";
      const target = e.target;
      if (target.tagName === "IMG" && target.closest(".page")) {
        const rect = target.getBoundingClientRect();
        zoomLens.style.display = "block";
        const lensSize = 300;
        const offsetX = lensSize / 2;
        const offsetY = lensSize / 2;
        zoomLens.style.left = e.pageX - offsetX + "px";
        zoomLens.style.top = e.pageY - offsetY + "px";
        zoomImg.src = target.src;
        zoomImg.style.left = -((e.clientX - rect.left) * zoomScale - 250) + "px";
        zoomImg.style.top = -((e.clientY - rect.top) * zoomScale - 125) + "px";
      } else {
        zoomLens.style.display = "none";
      }
    });
  });
</script>

</body>
</html>
