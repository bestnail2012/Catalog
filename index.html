<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ÎπÑÏóêÏä§Ìä∏ Ïπ¥Îã¨Î°úÍ∑∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/3/turn.min.js"></script>
  <style>
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f9f9f9; }
    .navbar {
      display: flex; justify-content: space-between; align-items: center;
      background-color: #333; color: white; padding: 10px 20px;
    }
    .navbar-left { font-size: 20px; }
    .navbar-right {
      display: flex; gap: 10px; align-items: center;
    }
    .sound-toggle {
      background-color: white; font-size: 18px; border: none;
      cursor: pointer; padding: 6px 12px; border-radius: 5px;
    }
    .navbar a {
      background-color: white; color: black; text-decoration: none;
      font-size: 16px; padding: 6px 12px; border-radius: 5px;
      display: flex; align-items: center;
    }
    .navbar a img {
      height: 24px; margin-right: 6px;
    }
    #intro {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #fff; z-index: 9999;
      display: flex; flex-direction: column;
      justify-content: center; align-items: center;
    }
    #intro h1 { font-size: 64px; margin: 0; font-weight: bold; }
    #intro h2 { font-size: 40px; margin: 10px 0 30px 0; }
    #intro button {
      padding: 12px 24px; font-size: 18px;
      background-color: #333; color: white; border: none;
      border-radius: 8px; cursor: pointer;
    }
    #flipbook {
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .page {
      display: flex; justify-content: center;
      align-items: center; background: white;
    }
    .page img {
      width: 100%; height: 100%; object-fit: contain; background-color: white;
    }
    .nav-buttons {
      text-align: center; position: fixed; bottom: 50px; width: 100%;
      background: rgba(255,255,255,0.95); z-index: 999;
      padding: 10px 0; display: flex; justify-content: center;
      align-items: center; gap: 4px; flex-wrap: nowrap; overflow-x: auto;
    }
    .nav-buttons button {
      font-size: 14px; padding: 6px 10px;
      background-color: #333; color: white; border: none;
      border-radius: 20px; cursor: pointer; transition: background 0.3s;
      white-space: nowrap;
    }
    .nav-buttons button:hover { background-color: #555; }
    .page-number {
      font-size: 13px; color: #555;
      white-space: nowrap;
    }
    .page-input {
      width: 40px; padding: 4px; font-size: 13px;
      border-radius: 5px; border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<div id="intro">
  <h1>B-EST</h1>
  <h2>CATALOG</h2>
  <button onclick="startCatalog()">ÌéºÏ≥êÎ≥¥Í∏∞</button>
</div>

<div class="navbar">
  <div class="navbar-left">ÎπÑÏóêÏä§Ìä∏ Ïπ¥Îã¨Î°úÍ∑∏</div>
  <div class="navbar-right">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>
    <a href="https://www.bestnail.kr" target="_blank">
      <img src="ÎπÑÏóêÏä§Ìä∏ Î°úÍ≥†(Îî±ÎßûÍ≤å).png" alt="Î°úÍ≥†">
      ÏáºÌïëÎ™∞
    </a>
  </div>
</div>

<div id="flipbook"></div>

<div class="nav-buttons">
  <button id="first">‚èÆ</button>
  <button id="prev">‚¨Ö Ïù¥Ï†Ñ</button>
  <span class="page-number" id="page-number">1 / 83</span>
  <input type="number" id="pageInput" min="1" max="83" class="page-input" placeholder="ÌéòÏù¥ÏßÄ" />
  <button id="next">Îã§Ïùå ‚û°</button>
  <button id="last">‚è≠</button>
</div>

<audio id="flipSound" src="page-flip.mp3" preload="auto"></audio>

<script>
  const totalPages = 83;
  const pages = [];
  let soundEnabled = true;

  function buildPages() {
    pages.length = 0;
    for (let i = 1; i <= totalPages; i++) {
      const num = String(i).padStart(2, '0');
      pages.push(`<div class='page'><img src='${num}.jpg' loading='lazy' /></div>`);
    }
  }

  function getDisplayMode() {
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const isPortrait = window.innerHeight > window.innerWidth;
    return isMobile && isPortrait ? 'single' : 'double';
  }

  function playFlipSound() {
    const audio = document.getElementById("flipSound");
    if (soundEnabled && audio) {
      audio.currentTime = 0;
      audio.play().catch(() => {});
    }
  }

  function toggleSound() {
    soundEnabled = !soundEnabled;
    document.getElementById("soundToggle").textContent = soundEnabled ? "üîä" : "üîá";
  }

  function updateButtons() {
    const total = totalPages;
    const current = $("#flipbook").turn("page");
    const view = $("#flipbook").turn("view");
    const text = view.length > 1 ? `${Math.min(...view)}-${Math.max(...view)} / ${total}` : `${current} / ${total}`;
    $("#page-number").text(text);
    $("#prev").css("display", current > 1 ? "inline-block" : "none");
    $("#next").css("display", current < total ? "inline-block" : "none");
  }

  function initializeFlipbook() {
    const maxWidth = 1000;
    const screenWidth = window.innerWidth;
    const width = Math.min(screenWidth * 0.95, maxWidth);
    const height = width * 1.3;
    const displayMode = getDisplayMode();

    const flipbook = $("#flipbook");
    if (flipbook.data("turn")) {
      flipbook.turn("destroy");
    }

    buildPages();
    flipbook.html(pages.join("\n"));

    flipbook.turn({
      width: displayMode === 'single' ? width : width * 2,
      height: height,
      autoCenter: true,
      display: displayMode,
      gradients: true,
      duration: 1200,
      elevation: 50,
      acceleration: true,
      turnCorners: "",
      when: {
        turning: function(e, page, view) {
          e.stopPropagation();
        }
      }
    });

    updateButtons();
  }

  function startCatalog() {
    document.getElementById("intro").style.display = "none";
    initializeFlipbook();
  }

  $(document).ready(function () {
    $(document).on("click", "#first", () => { $("#flipbook").turn("page", 1); playFlipSound(); });
    $(document).on("click", "#last", () => { const total = $("#flipbook").turn("pages"); $("#flipbook").turn("page", total); playFlipSound(); });
    $(document).on("click", "#prev", () => { $("#flipbook").turn("previous"); playFlipSound(); });
    $(document).on("click", "#next", () => { $("#flipbook").turn("next"); playFlipSound(); });

    $(document).on("keydown", "#pageInput", function(e) {
      if (e.key === "Enter") {
        const input = parseInt($(this).val(), 10);
        const total = $("#flipbook").turn("pages");
        if (!isNaN(input) && input >= 1 && input <= totalPages) {
          $("#flipbook").turn("page", input);
          playFlipSound();
        } else {
          alert("1Î∂ÄÌÑ∞ " + totalPages + " ÏÇ¨Ïù¥Ïùò Ï†ïÏàòÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");
        }
      }
    });

    let lastWidth = window.innerWidth;
    $(window).on("resize orientationchange", () => {
      if (Math.abs(window.innerWidth - lastWidth) > 50) {
        lastWidth = window.innerWidth;
        initializeFlipbook();
      }
    });

    let prevRatio = window.devicePixelRatio;
    setInterval(() => {
      if (window.devicePixelRatio !== prevRatio) {
        prevRatio = window.devicePixelRatio;
        initializeFlipbook();
      }
    }, 500);

    $("#flipbook").on("turned", () => {
      updateButtons();
      playFlipSound();
    });

    document.addEventListener("click", function (e) {
      const flipbook = document.getElementById("flipbook");
      if (!flipbook.contains(e.target)) return;
      if ($("#flipbook").turn("animating")) return;

      const rect = flipbook.getBoundingClientRect();
      const xRatio = (e.clientX - rect.left) / rect.width;
      if (xRatio > 0.5) {
        $("#flipbook").turn("next");
      } else {
        $("#flipbook").turn("previous");
      }
      playFlipSound();
    });
  });
</script>

</body>
</html>
