<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>B-EST CATALOG</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script>
let isInitialLoad = true;
</script>
<script>
// Ïù∏Ìä∏Î°úÎ°ú Ïù¥Îèô + Ï†ÄÏû•Îêú ÌéòÏù¥ÏßÄ Î≥µÏõê Î≤ÑÌäº ÏßÄÏõê
  localStorage.removeItem("lastPage");
}

// Î°úÎî© ÌÖçÏä§Ìä∏ Ïï†ÎãàÎ©îÏù¥ÏÖò (0.5Ï¥àÎßàÎã§ Î≥ÄÍ≤Ω)
const loadingTexts = ["Î°úÎî© Ï§ë", "Î°úÎî© Ï§ë.", "Î°úÎî© Ï§ë..", "Î°úÎî© Ï§ë...", "Î°úÎî© Ï§ë"];
let loadingIndex = 0;
setInterval(() => {
  const span = document.querySelector("#loading span");
  if (span) {
    span.textContent = loadingTexts[loadingIndex];
    loadingIndex = (loadingIndex + 1) % loadingTexts.length;
  }
}, 500);



// PCÏóêÏÑúÎèÑ ÏÉàÎ°úÍ≥†Ïπ® ÌõÑ Ï≤´ ÌéòÏù¥ÏßÄ ÎÑòÍπÄ Ïãú ÏÜåÎ¶¨ Ï†úÍ±∞ Î≥¥Ïû•
let hasUserInteracted = false;
$("#flipbook").on("mousedown touchstart", function () {
  hasUserInteracted = true;
});

function playFlipSound() {
  if (isInitialLoad || !hasUserInteracted) return;
  const audio = document.getElementById("flipSound");
  audio.volume = soundLevel;
  audio.currentTime = 0;
  audio.play().catch(() => {});
}
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/3/turn.min.js"></script>

  <style>
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f9f9f9; }
    .navbar {
      display: flex; justify-content: space-between; align-items: center;
      background-color: #333; color: white; padding: 10px 20px;
    }
    .navbar-left { display: flex; align-items: center; gap: 12px; }
    .navbar-right { display: flex; align-items: center; gap: 12px; margin-left: auto; }
    .navbar a {
      background-color: white; color: black; text-decoration: none;
      font-size: 16px; padding: 6px 12px; border-radius: 5px;
      display: flex; align-items: center;
    }
    .navbar a img { height: 24px; margin-right: 6px; }
    .sound-toggle {
      background-color: white; font-size: 18px; border: none;
      cursor: pointer; padding: 6px 12px; border-radius: 5px;
    }
    #intro {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
    }
    #intro h1 { font-size: 64px; margin: 0; font-weight: bold; }
    #intro h2 { font-size: 40px; margin: 10px 0 30px 0; }
    #intro button {
      padding: 12px 24px; font-size: 18px; background-color: #333; color: white;
      border: none; border-radius: 8px; cursor: pointer;
    }
    #loading {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(255,255,255,0.8); z-index: 9998;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
    }
    #loading img { width: 60px; height: auto; }
    #loading span { margin-top: 10px; font-size: 18px; color: #333; }
    #flipbook {
  margin: 0 auto;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
  touch-action: manipulation;
  display: flex;
  justify-content: center;
  align-items: center;
}
    .page {
      display: flex; justify-content: center; align-items: center; background: white;
      position: relative;
    }
    .page img {
      max-width: 100%; max-height: 100%; object-fit: contain; display: block; margin: auto;
    }
    .page-number-display {
      position: absolute; bottom: 10px; width: 100%; text-align: center;
      font-size: 16px; font-weight: bold; color: #555;
    }
    @media (max-width: 600px) {
  .page-number-display {
    font-size: 10px !important;
  }
  .navbar-left span {
    font-size: 16px !important;
  }
}

.nav-buttons {
  text-align: center;
  position: fixed;
  bottom: 50px;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  background: rgba(255,255,255,0.95);
  z-index: 999;
  padding: 10px 0;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 4px;
  flex-wrap: nowrap;
  overflow-x: auto;
  transition: opacity 0.3s ease;
}
    .nav-buttons button {
  font-size: 18px;
  padding: 10px 18px;
  background-color: #333;
  color: white;
  border: none;
  border-radius: 24px;
  cursor: pointer;
  transition: background 0.3s;
  white-space: nowrap;
  font-family: 'Segoe UI', sans-serif;
  font-weight: bold;
}
    .nav-buttons button:hover { background-color: #555; }
    .page-slider {
  width: 180px;
  height: 6px;
}
  </style>
</head>
<body>

<div id="intro">
  <h1>B-EST</h1>
  <h2>CATALOG</h2>
  <button onclick="startCatalog()">ÌéºÏ≥êÎ≥¥Í∏∞</button>
</div>

<div id="loading">
  <img src="ÎπÑÏóêÏä§Ìä∏ Î°úÍ≥†(Îî±ÎßûÍ≤å).png" alt="Î°úÎî© Ï§ë..." />
  <span>Î°úÎî© Ï§ë...</span>
</div>

<div class="navbar">
  <div class="navbar-left">
    <span style="font-weight:bold; font-size:22px; color:white;">B-EST CATALOG</span>
  </div>
  <div class="navbar-right">
  <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>
  <a href="https://www.bestnail.kr" target="_blank">
    <img src="ÎπÑÏóêÏä§Ìä∏ Î°úÍ≥†(Îî±ÎßûÍ≤å).png" alt="Î°úÍ≥†">ÏáºÌïëÎ™∞
  </a>
</div>
</div>

<div id="flipbook"></div>

<div id="sliderPageDisplay" style="position:absolute; top:-30px; background:#333; color:#fff; font-size:14px; padding:4px 8px; border-radius:12px; display:none; pointer-events:none; font-weight:bold;"></div>
  <button id="next">Îã§Ïùå ‚û°</button>
  <button id="last">‚è≠</button>
</div>

<audio id="flipSound" src="page-flip.mp3" preload="auto"></audio>

<script>
const totalPages = 83;
const pages = [];
let soundLevel = 0.5;
let resizeTimeout;
let lastPage = 1;
let isInitialLoad = true; // ÏÉàÎ°úÍ≥†Ïπ® Í∞êÏßÄÏö©

function buildPages() {
  pages.length = 0;
  for (let i = 1; i <= totalPages; i++) {
    const num = String(i).padStart(2, '0');
    pages.push(`<div class='page'><img src='${num}.jpg' loading='lazy' /><div class='page-number-display'>-${i}-</div></div>`);
  }
}

function waitForImages(callback) {
  const imgs = $("#flipbook img");
  let loaded = 0;
  if (imgs.length === 0) return callback();
  imgs.each(function () {
    if (this.complete) {
      if (++loaded === imgs.length) callback();
    } else {
      $(this).on("load error", function () {
        if (++loaded === imgs.length) callback();
      });
    }
  });
  setTimeout(() => {
    if (loaded < imgs.length) callback();
  }, 5000);
}

function initializeFlipbook(startPage = 1) {
  $("#loading").show();
  const flipbook = $("#flipbook");
  if (flipbook.data("turn")) flipbook.turn("destroy").html("");
  const screenWidth = window.innerWidth;
  const maxWidth = 1200;
  // displayMode ÏÑ†Ïñ∏Ïù¥ Î®ºÏ†Ä ÏôÄÏïº Ìï®
const displayMode = window.innerHeight > window.innerWidth ? 'single' : 'double';
const width = displayMode === 'single' && screenWidth < 600 ? screenWidth : Math.min(screenWidth * 0.95, maxWidth);
  const height = width * 1.3;
  const displayMode = window.innerHeight > window.innerWidth ? 'single' : 'double';

  flipbook.html(pages.join(""));
  waitForImages(() => {
    try {
      flipbook.turn({
        duration: isInitialLoad ? 0 : 1200,
        width: displayMode === 'single' ? width : width * 2,
        height: height,
        display: displayMode,
        autoCenter: true,
        gradients: true,
        elevation: 50,
        acceleration: true,
      }).turn("page", startPage);
      updateButtons();
    } catch (e) {
      console.error("Flipbook Ï¥àÍ∏∞Ìôî Ïò§Î•ò", e);
    }
    $("#loading").hide();
  });
  setTimeout(() => {
    if ($("#loading").is(":visible")) {
      $("#loading").hide();
    }
  }, 8000);
}

function updateButtons() {
  const current = $("#flipbook").turn("page");
  $("#pageSlider").val(current);
  lastPage = current;
  localStorage.setItem("lastPage", current);
}

function playFlipSound() {
  if (isInitialLoad) return; // ÏÉàÎ°úÍ≥†Ïπ® ÌõÑ Ï¥àÍ∏∞ ÎÑòÍπÄÏóêÎäî ÏÜåÎ¶¨ ÏÉùÎûµ
  const audio = document.getElementById("flipSound");
  audio.volume = soundLevel;
  audio.currentTime = 0;
  audio.play().catch(() => {});
}

function toggleSound() {
  if (soundLevel === 0.5) {
    soundLevel = 0;
    document.getElementById("soundToggle").textContent = "üîá";
  } else if (soundLevel === 0) {
    soundLevel = 1;
    document.getElementById("soundToggle").textContent = "üîä";
  } else {
    soundLevel = 0.5;
    document.getElementById("soundToggle").textContent = "üîâ";
  }
}

function startCatalog() {
  const saved = localStorage.getItem('lastPage');
  lastPage = saved ? parseInt(saved) : 1;
  document.getElementById("intro").style.display = "none";
  buildPages();
  initializeFlipbook(lastPage);
}

$(document).ready(function () {
  let navVisible = true;
  let hideNavTimeout;

  function showNav() {
    if (!navVisible) {
      $('.nav-buttons').css('opacity', 1);
      navVisible = true;
    }
    clearTimeout(hideNavTimeout);
    hideNavTimeout = setTimeout(() => {
      if (window.innerWidth <= 600) {
        $('.nav-buttons').css('opacity', 0);
        navVisible = false;
      }
    }, 2000);
  }

  $(document).on('touchstart touchmove mousemove', showNav);
  showNav();
  $("#first").click(() => { $("#flipbook").turn("page", 1); playFlipSound(); });
  $("#last").click(() => { $("#flipbook").turn("page", totalPages); playFlipSound(); });
  $("#prev").click(() => { $("#flipbook").turn("previous"); playFlipSound(); });
  $("#next").click(() => { $("#flipbook").turn("next"); playFlipSound(); });

  $("#pageSlider").on("input change", function () {
  const val = parseInt(this.value);
  if (!isNaN(val) && val >= 1 && val <= totalPages) {
    $("#flipbook").turn("page", val);
    playFlipSound();
    $("#sliderPageDisplay").text(`ÌéòÏù¥ÏßÄ ${val}`).css("display", "block");
    clearTimeout($("#sliderPageDisplay").data("hideTimer"));
    const hideTimer = setTimeout(() => { $("#sliderPageDisplay").fadeOut(200); }, 1000);
    $("#sliderPageDisplay").data("hideTimer", hideTimer);
  }
});

  $("#flipbook").on("click", function (e) {
    const rect = this.getBoundingClientRect();
    const x = e.clientX - rect.left;
    if (x > rect.width / 2) {
      $("#flipbook").turn("next");
    } else {
      $("#flipbook").turn("previous");
    }
    playFlipSound();
  });

  $(window).on("resize orientationchange", () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      localStorage.setItem('lastPage', lastPage);
      location.reload();
    }, 300);
  });

  $("#flipbook").on("turned", () => {
    updateButtons();
    playFlipSound();
    isInitialLoad = false; // Ï≤´ ÌéòÏù¥ÏßÄ ÎÑòÍπÄ ÌõÑÎ∂ÄÌÑ∞ ÏÜåÎ¶¨ ÌóàÏö©
  });

  const savedPage = localStorage.getItem('lastPage');
  if (savedPage) {
    startCatalog();
  } else {
    document.getElementById("intro").style.display = "flex";
  }
});
</script>
</body>
</html>
